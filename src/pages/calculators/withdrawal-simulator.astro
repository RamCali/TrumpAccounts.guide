---
import CalculatorLayout from '../../layouts/CalculatorLayout.astro';
import WithdrawalSimulator from '../../components/calculators/WithdrawalSimulator';
import CalloutBox from '../../components/ui/CalloutBox.astro';
import Accordion from '../../components/ui/Accordion.astro';
import limits from '../../data/contribution-limits.json';

const faqs = [
  {
    question: 'When can my child withdraw from a Trump Account?',
    answer: `No withdrawals are allowed before age ${limits.growthPhaseEndAge}, except for rollovers, return of excess contributions, or death of the beneficiary. At age ${limits.iraConversionAge}, the account converts to a traditional IRA and standard IRA withdrawal rules apply.`,
  },
  {
    question: 'How are Trump Account withdrawals taxed?',
    answer: 'After the account converts to a traditional IRA at age 18, withdrawals are taxed as ordinary income. The tax rate depends on your child\'s total income in the year they withdraw. If they withdraw while in college with low income, the tax rate could be very low (10-12%).',
  },
  {
    question: 'Is there a penalty for withdrawing before age 59½?',
    answer: 'Yes. After the account becomes an IRA at 18, withdrawals before age 59½ incur a 10% early withdrawal penalty on top of ordinary income tax. Exceptions include first-time home purchase ($10,000 lifetime), qualified education expenses, and certain hardship situations.',
  },
  {
    question: 'What is the best age to withdraw?',
    answer: 'It depends on your child\'s goals. Withdrawing at 18 for college means a low tax rate but loses decades of compounding. Waiting until 59½ or later avoids the 10% penalty and maximizes growth. Use the simulator above to compare different ages.',
  },
  {
    question: 'Can my child convert to a Roth IRA instead of withdrawing?',
    answer: 'Yes. After the Trump Account converts to a traditional IRA at 18, your child can convert some or all of it to a Roth IRA. They would pay income tax on the converted amount, but future growth and qualified withdrawals would be tax-free.',
  },
  {
    question: 'What if my child never withdraws the money?',
    answer: 'The money stays in the IRA and keeps growing tax-deferred. There are no required minimum distributions (RMDs) until age 73 under current law. Leaving the money invested is often the best strategy for long-term wealth building.',
  },
];
---

<CalculatorLayout
  title="Trump Account Withdrawal & Tax Simulator"
  description="See how much you keep after taxes and penalties when withdrawing from a Trump Account at different ages. Compare 18, 25, 30, 59½, and 65."
  calculatorName="Withdrawal Simulator"
  slug="withdrawal-simulator"
  abstract="Simulates after-tax withdrawal amounts from a Section 530A Trump Account at various ages, including the IRA conversion at 18 and early withdrawal penalties."
>
  <section class="mb-8">
    <h2 class="mb-3 text-xl font-bold text-white">How Much Will Your Child Actually Keep?</h2>
    <p class="mb-4 text-gray-300">
      A Trump Account grows tax-deferred, but withdrawals are taxed as ordinary income once it converts to a traditional IRA at age {limits.iraConversionAge}. The amount your child keeps depends on <strong class="text-white">when</strong> they withdraw and <strong class="text-white">how much</strong> they earn that year.
    </p>
    <p class="mb-4 text-gray-300">
      This simulator shows the after-tax amount at different withdrawal ages — including the 10% early withdrawal penalty that applies before age 59½. Compare scenarios to find the best strategy.
    </p>

    <div class="mb-6 grid gap-3 sm:grid-cols-3">
      <div class="rounded-lg border border-surface-600 bg-surface-800 p-4 text-center">
        <p class="text-sm text-gray-400">Age 18-59</p>
        <p class="text-lg font-bold text-amber-400">Income tax + 10% penalty</p>
        <p class="text-xs text-gray-500">Early withdrawal rules apply</p>
      </div>
      <div class="rounded-lg border border-surface-600 bg-surface-800 p-4 text-center">
        <p class="text-sm text-gray-400">Age 59½+</p>
        <p class="text-lg font-bold text-mint-400">Income tax only</p>
        <p class="text-xs text-gray-500">No penalty after 59½</p>
      </div>
      <div class="rounded-lg border border-surface-600 bg-surface-800 p-4 text-center">
        <p class="text-sm text-gray-400">Roth conversion</p>
        <p class="text-lg font-bold text-gold-400">Tax-free later</p>
        <p class="text-xs text-gray-500">Pay tax now, grow tax-free</p>
      </div>
    </div>

    <CalloutBox type="tip" title="Low income = low tax rate">
      <p>
        If your child withdraws at 18 while in college with little other income, they may pay only 10-12% in federal tax. A $100,000 balance at 18 could mean $85,000+ after taxes — with no penalty if they use exceptions for education or a first home.
      </p>
    </CalloutBox>
  </section>

  <WithdrawalSimulator client:visible />

  <section class="mt-10">
    <h2 class="mb-4 text-xl font-bold text-white">Frequently Asked Questions</h2>
    <Accordion items={faqs} />

    <div class="mt-6">
      <p class="text-sm text-gray-400">
        Want to see how much the account will grow before withdrawals? Use the <a href="/calculators/growth-calculator" class="text-gold-400 hover:text-gold-300">growth calculator</a>. For a full breakdown of Trump Account tax rules, see our <a href="/faq/taxes" class="text-gold-400 hover:text-gold-300">tax FAQ</a>.
      </p>
    </div>
  </section>
</CalculatorLayout>
